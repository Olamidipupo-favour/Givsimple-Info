{% extends "base.html" %}

{% block title %}Edit Tag - {{ tag.token }} - GivSimple{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>
        <i class="fas fa-edit me-2"></i>Edit Tag: <code>{{ tag.token }}</code>
    </h2>
    <a href="{{ url_for('admin.tag_detail', tag_id=tag.id) }}" class="btn btn-outline-primary">
        <i class="fas fa-arrow-left me-1"></i>Back to Details
    </a>
</div>

<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-edit me-2"></i>Tag Settings
                </h5>
            </div>
            <div class="card-body">
                <form method="POST">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    
                    <div class="mb-3">
                        <label for="token" class="form-label">Token</label>
                        <input type="text" class="form-control" id="token" name="token" 
                               value="{{ form.token.data or tag.token }}" readonly>
                        <div class="form-text">Token cannot be changed after creation.</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="status" class="form-label">Status</label>
                        <select class="form-select" id="status" name="status" required>
                            <option value="unassigned" {% if (form.status.data or tag.status.value) == 'unassigned' %}selected{% endif %}>Unassigned</option>
                            <option value="registered" {% if (form.status.data or tag.status.value) == 'registered' %}selected{% endif %}>Registered</option>
                            <option value="active" {% if (form.status.data or tag.status.value) == 'active' %}selected{% endif %}>Active</option>
                            <option value="blocked" {% if (form.status.data or tag.status.value) == 'blocked' %}selected{% endif %}>Blocked</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label for="target_url" class="form-label">Target URL</label>
                        <input type="url" class="form-control" id="target_url" name="target_url" 
                               value="{{ form.target_url.data or tag.target_url or '' }}" 
                               placeholder="https://example.com">
                        <div class="form-text">The URL this token will redirect to when active.</div>
                    </div>
                    
                    <div class="d-flex justify-content-between">
                        <a href="{{ url_for('admin.tag_detail', tag_id=tag.id) }}" class="btn btn-outline-secondary">
                            <i class="fas fa-times me-1"></i>Cancel
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-1"></i>Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Current Information -->
        <div class="card mt-4">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>Current Information
                </h6>
            </div>
            <div class="card-body">
                <dl class="row mb-0">
                    <dt class="col-sm-3">Current Status:</dt>
                    <dd class="col-sm-9">
                        {% if tag.status.value == 'active' %}
                            <span class="badge bg-success">Active</span>
                        {% elif tag.status.value == 'unassigned' %}
                            <span class="badge bg-warning">Unassigned</span>
                        {% elif tag.status.value == 'registered' %}
                            <span class="badge bg-info">Registered</span>
                        {% elif tag.status.value == 'blocked' %}
                            <span class="badge bg-danger">Blocked</span>
                        {% endif %}
                    </dd>
                    
                    <dt class="col-sm-3">Current URL:</dt>
                    <dd class="col-sm-9">
                        {% if tag.target_url %}
                            <a href="{{ tag.target_url }}" target="_blank">{{ tag.target_url }}</a>
                        {% else %}
                            <span class="text-muted">None</span>
                        {% endif %}
                    </dd>
                    
                    <dt class="col-sm-3">Buyer:</dt>
                    <dd class="col-sm-9">
                        {% if tag.buyer %}
                            {{ tag.buyer.name }} ({{ tag.buyer.email }})
                        {% else %}
                            <span class="text-muted">None</span>
                        {% endif %}
                    </dd>
                </dl>
            </div>
        </div>
    </div>
</div>
{% endblock %}
